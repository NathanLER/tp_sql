#Q1
```SQL
SELECT noCli,nom,prenom,adresse,cpo,ville
FROM clients
where nom like 'D%'
```

#Q2
```SQL
SELECT nom,prenom
from clients
```

#Q3
```SQL
SELECT noFic,etat,nom,prenom
from clients
INNER JOIN fiches on clients.noCli = fiches.noCli
WHERE cpo LIke '44%'
```

#Q4
```SQL
SELECT fiches.noFic,nom,prenom,lignesfic.refart,designation,depart,retour,prixJour,(DATEDIFF(COALESCE(lignesFic.retour, NOW()), lignesFic.depart)+1) * tarifs.prixJour AS montant
from clients
INNER JOIN fiches ON clients.noCLi = fiches.noCli
INNER JOIN lignesfic on fiches.noFic = lignesfic.noFic
INNER JOIN articles on lignesfic.refart = articles.refart
INNER JOIN grilleTarifs ON articles.codeCate = grilleTarifs.codeCate
INNER JOIN tarifs on grilleTarifs.codeTarif = tarifs.codeTarif
where fiches.noFic = 1002
GROUP BY refArt
```

#Q5
```SQL
Select CASE 
        WHEN articles.codeGam = 'hg' THEN 'Haut de gamme'
        WHEN articles.codeGam = 'mg' THEN 'Moyenne gamme'
        WHEN articles.codeGam = 'pr' THEN 'Matériel Professionnel'
        WHEN articles.codeGam = 'eg' THEN 'Entrée de gamme'
        ELSE 'Autre '
    END AS gamme,AVG(tarifs.prixJour) as tarif_journalier_moyen
FROM tarifs
JOIN grilleTarifs ON tarifs.codeTarif = grilleTarifs.codeTarif
JOIN articles ON grilleTarifs.codeGam = articles.codeGam
GROUP BY articles.codeGam;
```

#Q6
```SQL
SELECT noFic,nom,prenom,refart,designation,depart,retour,prixJour,montant, SUM(montant) OVER () as Total
From (
SELECT fiches.noFic,nom,prenom,lignesfic.refart,designation,depart,retour,prixJour,(DATEDIFF(COALESCE(lignesFic.retour, NOW()), lignesFic.depart)+1) * tarifs.prixJour AS montant
from clients
INNER JOIN fiches ON clients.noCLi = fiches.noCli
INNER JOIN lignesfic on fiches.noFic = lignesfic.noFic
INNER JOIN articles on lignesfic.refart = articles.refart
INNER JOIN grilleTarifs ON articles.codeCate = grilleTarifs.codeCate
INNER JOIN tarifs on grilleTarifs.codeTarif = tarifs.codeTarif
where fiches.noFic = 1002
GROUP BY refArt
) as t
```

#Q7
```SQL
select categories.libelle as libelle, 
CASE 
    WHEN gammes.codeGam = "EG" THEN "Entrée de gamme" 
    WHEN gammes.codeGam = "MG" THEN "Moyenne gamme"
    WHEN gammes.codeGam = "HG" THEN "Haute gamme"
    WHEN gammes.codeGam = "PR" THEN "Materiel professionnel"
    ELSE  'autre'
END as gamme, tarifs.libelle as tarif, prixjour
from gammes
inner join grilleTarifs on gammes.codegam = grilleTarifs.codegam
inner join tarifs on grilleTarifs.codetarif = tarifs.codetarif
inner join categories on grilleTarifs.codecate = categories.codecate
order by gammes.codegam;
```

#Q8
```SQL
SELECT articles.refart,articles.designation,count(lignesFic.refart) as nbLocation
FROM articles
INNER JOIN categories ON articles.codeCate = categories.codeCate
INNER JOIN lignesfic ON lignesfic.refart = articles.refart
WHERE categories.libelle= 'SURF'
GROUP BY articles.refart
```


#Q9
```SQL
SELECT AVG(total) as nb_lignes_moyen_par_fiche
FROM(SELECT COUNT(noFic)as total
FROM lignesFic
GROUP BY noFic) as total
```

#Q10
```SQL
SELECT categories.libelle,COUNT(lignesFic.noFic)
FROM lignesfic
INNER JOIN articles on articles.refart = lignesFic.refArt
INNER JOIN categories on categories.codeCate = articles.codeCate
WHERE categories.libelle = 'Patinette' or categories.libelle = 'Ski alpin' or categories.libelle = 'Surf'
GROUP BY categories.libelle
```

#Q11
```SQL
SELECT AVG(total) as montant_moyen_une_fiche_de_location  
FROM(SELECT (DATEDIFF(COALESCE(lignesFic.retour, NOW()), lignesFic.depart)+1) * tarifs.prixJour AS total
FROM lignesfic
INNER JOIN articles on articles.refart = lignesFic.refArt
INNER JOIN categories on categories.codeCate = articles.codeCate
INNER Join grilleTarifs on grilleTarifs.codeCate = categories.codeCate
INNER JOIN tarifs on tarifs.codeTarif = grilleTarifs.codeTarif
) as total
```
